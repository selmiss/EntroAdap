# Tiny Test Dataset Configuration
# Ultra-fast loading for development and testing

# Model configuration
model:
  hidden_dim: 256
  num_layers: 6
  dropout: 0.1
  update_coords: true
  use_layernorm: true
  num_rbf: 32
  rbf_max: 10.0
  
  # Reconstruction head parameters
  num_elements: 119
  num_dist_bins: 64
  dist_min: 0.0
  dist_max: 20.0
  
  # Loss weights
  element_weight: 1.0
  dist_weight: 1.0
  noise_weight: 1.0

# Data configuration
data:
  # Tiny test datasets (100 samples each)
  # Generated by: python scripts/create_tiny_test_datasets.py
  train_data_path:
    - data/encoder/molecules/tiny_test.parquet
    - data/encoder/protein/tiny_test.parquet
    - data/encoder/nacid/dna_tiny_test.parquet
    - data/encoder/nacid/rna_tiny_test.parquet
    # Note: RNA dataset excluded due to file error
  
  # No sample limits needed (already tiny)
  max_samples_per_dataset: null
  
  # Validation split
  val_split_ratio: 0.2  # Use 20% for val since datasets are small
  stratified_val_split: true
  
  cache_dir: ./data/.cache
  use_modality_sampler: true
  
  # Masking parameters
  node_mask_prob: 0.15
  noise_std: 0.1
  use_soft_dist_targets: false
  soft_dist_sigma: 0.5

# Training configuration
training:
  output_dir: ./checkpoints/aa_encoder_tiny_test
  
  # Small batches for tiny dataset
  per_device_train_batch_size: 4
  per_device_eval_batch_size: 4
  
  # Short training for testing
  learning_rate: 1.0e-4
  num_train_epochs: 2
  warmup_steps: 10
  
  # Frequent logging for debugging
  logging_steps: 5
  save_steps: 50
  eval_steps: 20
  evaluation_strategy: steps
  save_strategy: steps
  load_best_model_at_end: false
  save_total_limit: 1
  
  # Optimization
  fp16: true
  bf16: false
  gradient_accumulation_steps: 1
  max_grad_norm: 1.0
  weight_decay: 0.01
  
  # Data loading
  dataloader_num_workers: 2
  dataloader_pin_memory: true
  dataloader_drop_last: false
  
  # Logging
  report_to: []  # Disable wandb for quick tests
  run_name: tiny_test
  logging_dir: null
  disable_tqdm: false
  
  # Misc
  seed: 42
  remove_unused_columns: false

# Wandb (disabled for quick tests)
wandb:
  project: AAEncoder-TinyTest
  entity: null
  tags: [aa_encoder, tiny_test, development]
  notes: Ultra-fast testing with tiny datasets

